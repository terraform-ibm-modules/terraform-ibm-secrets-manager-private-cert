{
  "products": [
    {
      "name": "deploy-arch-secrets-manager-private-cert",
      "label": "Cloud automation for Secrets Manager private certificate",
      "product_kind": "solution",
      "tags": [
        "ibm_created",
        "target_terraform",
        "terraform",
        "solution",
        "security",
        "platform_engineering"
      ],
      "keywords": [
        "Private certificate",
        "Secrets Manager",
        "IaC",
        "infrastructure as code",
        "terraform",
        "solution"
      ],
      "short_description": "Creates and configures a Secrets Manager private certificate.",
      "long_description": "This deployable architecture is used to create a private certificate within an existing instance of IBM Cloud Secrets Manager. The existing Secrets Manager instance must be configured with a Private Certificate Engine, which is necessary for managing and issuing private certificates. This solution simplifies the process of provisioning certificates by automating the necessary infrastructure steps, ensuring secure and consistent certificate creation aligned with your organization's security policies. \n\nLeverage [Terraform IBM Modules](https://github.com/terraform-ibm-modules) to shape and scale your solutions. You can integrate Terraform IBM Modules (TIM) to extend functionality and design a solution tailored to your environment and operations needs. These modules offer reusable, customizable elements that follow IBM Cloud's recommended practices. You can access the [source code and documentation](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-private-cert) and use it to extend your current architecture or create new solutions.",
      "offering_docs_url": "https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-private-cert/blob/main/README.md",
      "offering_icon_url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-secrets-manager-private-cert/main/images/secrets_manager_private_cert.svg",
      "provider_name": "IBM",
      "features": [
        {
          "title": "Certificate Template",
          "description": "Creates and manages certificate templates to define the parameters to apply to the private certificates."
        },
        {
          "title": "Certificate Signing Request",
          "description": "Facilitates the creation of a certificate within IBM Secrets Manager."
        },
        {
          "title": "Certificate Rotation",
          "description": "Defines the rotation policy for the certificate, including whether auto-rotation is enabled and the interval at which the certificate should be rotated."
        },
        {
          "title": "Secrets Manager integration",
          "description": "This solution provides an optional capability to integrate with [Cloud automation for Secrets Manager](https://cloud.ibm.com/catalog/7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3/architecture/deploy-arch-ibm-secrets-manager-6d6ebc76-7bbd-42f5-8bc7-78f4fabd5944-global) to automatically provision a Secrets Manager instance if one does not already exist."
        },
        {
          "title": "Composable and Extensible Architecture",
          "description": "This architecture illustrates how Terraform IBM Modules(TIM) can be integrated to deliver a complete solution on IBM Cloud. Each module is a reusable, and validated component for security, compliance, and operational IBM best practices. You can deploy this architecture as-is or configure it as code by leveraging the underlying modules to fit your specific requirements. Explore the [source code and documentation](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-private-cert) to adapt, extend, or create entirely new solutions using these building blocks."
        }
      ],
      "support_details": "This product is in the community registry. As such support is handled through the originated repo. If you experience issues please open an issue in that repository [here](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-private-cert/issues). Please note this product is not supported via the IBM Cloud Support Center.",
      "flavors": [
        {
          "label": "Fully configurable",
          "name": "fully-configurable",
          "install_type": "fullstack",
          "short_description": "Ideal for users who want to provision a private certificate on an existing secrets manager instance with a private certificate engine.",
          "working_directory": "solutions/fully-configurable",
          "architecture": {
            "features": [
              {
                "title": " ",
                "description": "Configured to use IBM secure by default standards, but can be edited to fit your use case."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "caption": "Secrets Manager Private Certificate",
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-secrets-manager-private-cert/main/reference-architectures/secrets_manager_private_cert.svg",
                  "type": "image/svg+xml"
                },
                "description": "This deployable architecture automates the creation of a private certificate in an IBM Cloud Secrets Manager instance, making it easier for users to securely manage certificates without manual effort. By integrating seamlessly with IBM Cloud Secrets Manager, this solution ensures that certificates are generated, stored, and maintained in a centralized and secure environment, aligned with enterprise security and compliance needs.<br>  <br>Certificate Rotation Support:<br>You can optionally define a rotation policy by setting auto-rotation, rotation intervals, and units (days, months, etc.). This allows the certificate to be automatically rotated according to your security compliance requirements.<br><br>Secrets Manager Integration:<br>This solution also supports integration with [Cloud automation for Secrets Manager](https://cloud.ibm.com/catalog/7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3/architecture/deploy-arch-ibm-secrets-manager-6d6ebc76-7bbd-42f5-8bc7-78f4fabd5944-global) instance automatically if one is not already available, enhancing provisioning flexibility in new environments.<br><br>Flexible Certificate Configuration:<br>Users can define all critical certificate attributes such as the certificate name, certificate common name, certificate alternate names , certificate signing request (CSR), certificate labels, certificate custom metadata, and certificate ttl.<br><br>Once deployed, users receive all relevant outputs based on their chosen return format, enabling easy integration of the certificate into their applications or infrastructure. This architecture is ideal for teams looking to simplify certificate management, improve operational efficiency, and maintain high security standards across their cloud workloads."
              }
            ]
          },
          "configuration": [
            {
              "key": "ibmcloud_api_key"
            },
            {
              "key": "existing_secrets_manager_crn",
              "required": true,
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'existing_secrets_manager_crn' is not valid.",
                  "value": "^crn:v\\d:(.*:){2}secrets-manager:(.*:)([aos]\\/[\\w_\\-]+):[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}::$"
                }
              ]
            },
            {
              "key": "prefix",
              "default_value": "dev",
              "random_string": {
                "length": 4
              },
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "Prefix must begin with a lowercase letter and may contain only lowercase letters, digits, and hyphens '-'. It must not end with a hyphen('-'), and cannot contain consecutive hyphens ('--'). It should not exceed 16 characters.",
                  "value": "^$|^__NULL__$|^[a-z](?!.*--)(?:[a-z0-9-]{0,14}[a-z0-9])?$"
                }
              ]
            },
            {
              "key": "existing_resource_group_name",
              "display_name": "resource_group",
              "custom_config": {
                "type": "resource_group",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "identifier": "rg_name"
                }
              },
              "default_value": "Default",
              "description": "The name of an existing resource group to provision the resources. [Learn more](https://cloud.ibm.com/docs/account?topic=account-rgs&interface=ui#create_rgs) about how to create a resource group.",
              "virtual": true
            },
            {
              "key": "secrets_manager_region",
              "required": true,
              "virtual": true,
              "description": "The region to provision a new Secrets Manager instance in.",
              "custom_config": {
                "type": "region",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "filterString": "service:secrets-manager",
                  "showKinds": [
                    "region"
                  ]
                }
              }
            },
            {
              "key": "secrets_manager_service_plan",
              "required": true,
              "virtual": true,
              "type": "string",
              "options": [
                {
                  "displayname": "Standard",
                  "value": "standard"
                },
                {
                  "displayname": "Trial",
                  "value": "trial"
                }
              ],
              "default_value": "standard",
              "description": "The pricing plan to use when provisioning a Secrets Manager instance. Possible values: `standard`, `trial`. You can create only one Trial instance of Secrets Manager per account. Before you can create a new Trial instance, you must delete the existing Trial instance and its reclamation. [Learn more](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-create-instance&interface=ui#upgrade-instance-standard)."
            },
            {
              "key": "endpoint_type",
              "options": [
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public",
                  "value": "public"
                }
              ]
            },
            {
              "key": "cert_name",
              "required": true,
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "cert_name must be 2 to 256 chars, start and end with alphanumeric or underscore, and only contain word characters, dots, or dashes.",
                  "value": "^\\w[\\w\\-.]{0,254}\\w$"
                }
              ]
            },
            {
              "key": "cert_description",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'cert_description' must be null or match /(.*?)/ and have length <= 1024.",
                  "value": "^(?:$|__NULL__|.{1,1024})$"
                }
              ]
            },
            {
              "key": "cert_secrets_group_id",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'cert_secrets_group_id' must be null or match the regular expression /^([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|default)$/ and have length >= 7 and <= 36.",
                  "value": "^$|^__NULL__$|^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|default)$"
                }
              ]
            },
            {
              "key": "cert_template",
              "required": true,
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'cert_template' must be 2–128 characters long and match /^[A-Za-z0-9][A-Za-z0-9]*(?:_?-?\\.?[A-Za-z0-9]+)*$/.",
                  "value": "^((?=.{2,128}$)[A-Za-z0-9][A-Za-z0-9]*(?:_?-?\\.?[A-Za-z0-9]+)*)$"
                }
              ]
            },
            {
              "key": "cert_csr",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'cert_csr' must match regular expression /^(-{5}BEGIN.+?-{5}[\\s\\S]+-{5}END.+?-{5})$/.",
                  "value": "^__NULL__$|^(-{5}BEGIN.+?-{5}[\\s\\S]+-{5}END.+?-{5})$"
                }
              ]
            },
            {
              "key": "cert_common_name",
              "required": true,
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'cert_common_name' must be 4–128 characters long and match regular expression /(.*?)/.",
                  "value": "^(?=.{4,128}$).+$"
                }
              ]
            },
            {
              "key": "cert_alt_names"
            },
            {
              "key": "cert_custom_metadata",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "supportedLanguages": [
                    "hcl"
                  ]
                }
              }
            },
            {
              "key": "cert_version_custom_metadata",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "supportedLanguages": [
                    "hcl"
                  ]
                }
              }
            },
            {
              "key": "cert_labels"
            },
            {
              "key": "return_format",
              "options": [
                {
                  "displayname": "pem",
                  "value": "pem"
                },
                {
                  "displayname": "pem_bundle",
                  "value": "pem_bundle"
                }
              ]
            },
            {
              "key": "private_key_format",
              "options": [
                {
                  "displayname": "der",
                  "value": "der"
                },
                {
                  "displayname": "pkcs8",
                  "value": "pkcs8"
                }
              ]
            },
            {
              "key": "cert_rotation"
            },
            {
              "key": "cert_ip_sans"
            },
            {
              "key": "cert_uri_sans"
            },
            {
              "key": "exclude_cn_from_sans",
              "options": [
                {
                  "displayname": "true",
                  "value": "true"
                },
                {
                  "displayname": "false",
                  "value": "false"
                }
              ]
            },
            {
              "key": "cert_ttl",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'cert_ttl' must match regular expression /^[0-9]+[s,m,h,d]{0,1}$/.",
                  "value": "^__NULL__$|^[0-9]+[s,m,h,d]{0,1}$"
                }
              ]
            },
            {
              "key": "cert_other_sans"
            },
            {
              "key": "root_ca_name",
              "type": "string",
              "required": true,
              "virtual": true,
              "default_value": "root-ca",
              "description": "The name of the Root Certificate Authority."
            },
            {
              "key": "root_ca_common_name",
              "type": "string",
              "required": true,
              "virtual": true,
              "default_value": "example-root.com",
              "description": "The common name of the Root Certificate Authority."
            },
            {
              "key": "intermediate_ca_name",
              "type": "string",
              "required": true,
              "virtual": true,
              "default_value": "intermediate-ca",
              "description": "The name of the Intermediate Certificate Authority."
            },
            {
              "key": "intermediate_ca_common_name",
              "type": "string",
              "required": true,
              "virtual": true,
              "default_value": "example-int.com",
              "description": "The common name of the Intermediate Certificate Authority."
            },
            {
              "key": "certificate_template_name",
              "type": "string",
              "required": true,
              "virtual": true,
              "default_value": "template",
              "description": "The name of the Certificate Template."
            },
            {
              "key": "template_max_ttl",
              "type": "string",
              "required": true,
              "virtual": true,
              "default_value": "8760h",
              "description": "Max TTL for the certificate template."
            },
            {
              "key": "provider_visibility",
              "hidden": true,
              "options": [
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ]
            }
          ],
          "iam_permissions": [
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "iam-access-groups",
              "notes": "[optional] Required for managing IAM access groups."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Administrator",
                "crn:v1:bluemix:public:iam::::serviceRole:Manager"
              ],
              "service_name": "secrets-manager",
              "notes": "[optional] Required for creating an Secrets Manager instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Viewer"
              ],
              "service_name": "resource-group",
              "notes": "Viewer access is required in the resource group you want to provision in."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "event-notifications",
              "notes": "[Optional] Required if you are configuring an Event Notifications Instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "sysdig-monitor",
              "notes": "[Optional] Required if configuring a Cloud Monitoring instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "logs",
              "notes": "[Optional] Required if configuring a Cloud Logs instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "hs-crypto",
              "notes": "[Optional] Required if you are creating/configuring keys in an existing Hyper Protect Crypto Services (HPCS) instance for encryption."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "kms",
              "notes": "[Optional] Required if you are creating/configuring Key Protect instance and keys for encryption."
            }
          ],
          "dependencies": [
            {
              "name": "deploy-arch-secrets-manager-private-cert-engine",
              "id": "571d2eb7-e416-40a4-aa95-be05e6155af8-global",
              "version": "v1.12.2",
              "flavors": [
                "fully-configurable"
              ],
              "catalog_id": "7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3",
              "optional": true,
              "on_by_default": true,
              "ignore_auto_referencing": [
                "*"
              ],
              "input_mapping": [
                {
                  "dependency_input": "prefix",
                  "version_input": "prefix",
                  "reference_version": true
                },
                {
                  "dependency_input": "existing_resource_group_name",
                  "version_input": "existing_resource_group_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "secrets_manager_region",
                  "version_input": "secrets_manager_region",
                  "reference_version": true
                },
                {
                  "dependency_output": "secrets_manager_crn",
                  "version_input": "existing_secrets_manager_crn"
                },
                {
                  "dependency_input": "secrets_manager_service_plan",
                  "version_input": "secrets_manager_service_plan",
                  "reference_version": true
                },
                {
                  "dependency_input": "root_ca_name",
                  "version_input": "root_ca_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "root_ca_common_name",
                  "version_input": "root_ca_common_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "intermediate_ca_name",
                  "version_input": "intermediate_ca_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "intermediate_ca_common_name",
                  "version_input": "intermediate_ca_common_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "certificate_template_name",
                  "version_input": "certificate_template_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "template_max_ttl",
                  "version_input": "template_max_ttl",
                  "reference_version": true
                },
                {
                  "dependency_output": "template_name",
                  "version_input": "cert_template"
                }
              ]
            }
          ],
          "dependency_version_2": true,
          "terraform_version": "1.12.2",
          "ignore_readme": true
        }
      ]
    }
  ]
}
